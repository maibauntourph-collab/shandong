import{r as i,j as e}from"./index-D-sX74-q.js";import{a as g}from"./api-tZUecBdR.js";const w=()=>{const[o,n]=i.useState([]),[N,h]=i.useState(!0),[c,b]=i.useState("all"),[a,m]=i.useState(null),[j,f]=i.useState(1),[S,d]=i.useState(1);i.useEffect(()=>{x()},[c,j]);const x=async()=>{h(!0);try{const s=new URLSearchParams({status:c==="all"?"":c,page:String(j),limit:"20"}),t=await(await g.get(`/api/inquiries?${s.toString()}`)).json();t.success?(n(t.data),d(t.pagination.totalPages)):(console.error("Failed to fetch inquiries:",t.message),n([]),d(1))}catch(s){console.error("Fetch error:",s),n([]),d(1)}finally{h(!1)}},v=async(s,l)=>{try{const u=await(await g.patch(`/api/inquiries/${s}`,{status:l})).json();u.success?(x(),(a==null?void 0:a._id)===s&&m({...a,status:l})):console.error("Failed to update status:",u.message)}catch(t){console.error("Update error:",t)}},p=s=>new Date(s).toLocaleDateString("ko-KR",{year:"numeric",month:"short",day:"numeric"}),r=s=>({pending:"대기중",contacted:"연락완료",confirmed:"확정",completed:"완료"})[s]||s;return e.jsxs("div",{className:"admin-inquiries",children:[e.jsxs("div",{className:"admin-page-header",children:[e.jsx("h1",{className:"admin-page-title",children:"예약/문의 관리"}),e.jsx("p",{className:"admin-page-subtitle",children:"고객 문의 및 예약을 관리합니다"})]}),e.jsx("div",{className:"inquiry-filters",children:["all","pending","contacted","confirmed","completed"].map(s=>e.jsx("button",{className:`filter-btn ${filter===s?"active":""}`,onClick:()=>setFilter(s),children:s==="all"?"전체":r(s)},s))}),e.jsxs("div",{className:"inquiry-layout",children:[e.jsx("div",{className:"admin-card inquiry-list",children:N?e.jsx("div",{className:"loading",children:"로딩 중..."}):o.length===0?e.jsx("div",{className:"empty-state",children:"문의가 없습니다."}):e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"고객명"}),e.jsx("th",{children:"행사유형"}),e.jsx("th",{children:"날짜"}),e.jsx("th",{children:"인원"}),e.jsx("th",{children:"상태"})]})}),e.jsx("tbody",{children:o.map(s=>e.jsxs("tr",{className:(a==null?void 0:a._id)===s._id?"selected":"",onClick:()=>m(s),children:[e.jsx("td",{children:s.name}),e.jsx("td",{children:s.eventType}),e.jsx("td",{children:p(s.eventDate)}),e.jsxs("td",{children:[s.guestCount,"명"]}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${s.status}`,children:r(s.status)})})]},s._id))})]})}),a&&e.jsxs("div",{className:"admin-card inquiry-detail",children:[e.jsx("h3",{children:"문의 상세"}),e.jsxs("div",{className:"detail-grid",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:"고객명"}),e.jsx("p",{children:a.name})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:"이메일"}),e.jsx("p",{children:a.email})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:"연락처"}),e.jsx("p",{children:a.phone})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:"행사유형"}),e.jsx("p",{children:a.eventType})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:"행사일"}),e.jsx("p",{children:p(a.eventDate)})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:"예상인원"}),e.jsxs("p",{children:[a.guestCount,"명"]})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("label",{children:"예산"}),e.jsx("p",{children:a.budget})]}),e.jsxs("div",{className:"detail-item full",children:[e.jsx("label",{children:"요청사항"}),e.jsx("p",{children:a.message||"없음"})]})]}),e.jsxs("div",{className:"status-actions",children:[e.jsx("label",{children:"상태 변경"}),e.jsx("div",{className:"status-buttons",children:["pending","contacted","confirmed","completed"].map(s=>e.jsx("button",{className:`status-btn ${s} ${a.status===s?"active":""}`,onClick:()=>v(a._id,s),children:r(s)},s))})]})]})]})]})};export{w as default};
